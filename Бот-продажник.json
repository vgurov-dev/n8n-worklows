{
  "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫",
  "nodes": [
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        -3008,
        -912
      ],
      "id": "7fbc5f8a-29ec-470d-a1b8-15b3f0f1021a",
      "name": "Embeddings Google Gemini",
      "notesInFlow": false,
      "credentials": {
        "googlePalmApi": {
          "id": "GW1wqXvW3BLftkCs",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('–¢—Ä–∏–≥–≥–µ—Ä: —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞').item.json.message.from.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3984,
        336
      ],
      "id": "1e8ca837-0c7c-4807-97f7-05b5611628b7",
      "name": "Send a text message",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "sGbtI9krrre8xcIi",
          "name": "Telegram account 2"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1E1LMgwJxse1tuUaMKnxqhBYyfsnypycfvEBF1mOdlS0",
          "mode": "list",
          "cachedResultName": "–£—Å–ª—É–≥–∏ (RAG)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E1LMgwJxse1tuUaMKnxqhBYyfsnypycfvEBF1mOdlS0/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–õ–∏—Å—Ç1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E1LMgwJxse1tuUaMKnxqhBYyfsnypycfvEBF1mOdlS0/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -3152,
        -1088
      ],
      "id": "f390f7a6-ca9f-42c5-894c-0065637024b0",
      "name": "–ë–µ—Ä–µ–º —É—Å–ª—É–≥–∏ —Å —Ç–∞–±–ª–∏—Ü—ã",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "x9fVIG0FwPZYmE81",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        -2944,
        -1088
      ],
      "id": "5c343c70-b091-461f-8cec-71d0ef334e7d",
      "name": "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –ë–î",
      "credentials": {
        "supabaseApi": {
          "id": "SrDl7p2I6NihUzh5",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "chunkOverlap": 100,
        "options": {}
      },
      "id": "9273b774-1225-4852-a746-7cc9ddbdec38",
      "name": "–°–æ–∑–¥–∞–Ω–∏–µ —á–∞–Ω–∫–æ–≤",
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "position": [
        -2832,
        -752
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "service",
                "value": "={{ $json.code }}"
              },
              {
                "name": "description",
                "value": "={{ $json.description }}"
              }
            ]
          }
        }
      },
      "id": "c8840a81-3647-436c-9a7b-53e31e778307",
      "name": "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "position": [
        -2832,
        -912
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.message.text }}",
        "options": {
          "systemMessage": "=–¢—ã ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–µ—Å–µ–π–ª—É –∏ –∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥—É –≤ –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞–±–æ—Ä —É—Å–ª—É–≥: –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –≤–Ω–µ–¥—Ä–µ–Ω–∏—è, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è. –ú—ã –Ω–µ –∑–∞–Ω–∏–º–∞–µ–º—Å—è –¥—Ä—É–≥–∏–º–∏ –≤–∏–¥–∞–º–∏ —Ä–∞–±–æ—Ç.\n–£ —Ç–µ–±—è –µ—Å—Ç—å:\n–æ—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã (–≤ —Ç–∞–±–ª–∏—Ü–µ n8n_chat_histories);\n—Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥ —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø–æ —Ç–∏–ø–∞–º (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è, –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ). –ö–∞–∂–¥–∞—è —É—Å–ª—É–≥–∞ –∏–º–µ–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å.\n–¢–≤–æ—è –∑–∞–¥–∞—á–∞:\n–ù–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–¥–æ–±—Ä–∞—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–¥–Ω–æ–º—É –∏–∑ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è, –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ).\n–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.\n–ù–µ –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ —É—Å–ª—É–≥–∏, —Ç–∏–ø—ã –∏–ª–∏ —Ü–µ–Ω—ã ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –µ—Å—Ç—å –≤–æ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, —É–∫–∞–∂–∏ —ç—Ç–æ –≤ summary.\n–ü—Ä–∞–≤–∏–ª–∞:\n–£—Å–ª—É–≥–∏ –±–µ—Ä–∏ —Ç–æ–ª—å–∫–æ –∏–∑ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ documents –∏ —Ç–æ–ª—å–∫–æ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤.\n–ï—Å–ª–∏ —É—Å–ª—É–≥–∞ —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç, –∫—Ä–∞—Ç–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–π –µ—ë –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–ª–∏–µ–Ω—Ç–∞, –Ω–æ –Ω–µ –º–µ–Ω—è–π —Ç–∏–ø, –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å.\n–ï—Å–ª–∏ —É—Å–ª—É–≥ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ, –≤—ã–±–µ—Ä–∏ 3‚Äì5 –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –ø–æ —Ç–∏–ø–∞–º, —á—Ç–æ–±—ã –ø–æ–∫—Ä—ã—Ç—å –Ω—É–∂–¥—ã –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—á–∞—Ç—å —Å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –ø–µ—Ä–µ–π—Ç–∏ –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é).\n–ü–æ–¥–∞—á–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–µ–ª–æ–≤–æ–π, –ø–æ–Ω—è—Ç–Ω–æ–π, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ç–æ, –∫–∞–∫ —É—Å–ª—É–≥–∞ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∫–ª–∏–µ–Ω—Ç–∞.\n–£—á–∏—Ç—ã–≤–∞–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è/–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ ‚Üí –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ/—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞.\n–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å  —Å—Ç—Ä–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ:\n\"client_summary\": \"<–∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –æ—Ç–≤–µ—Ç–æ–≤ (2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)>\",\n\"proposal_title\": \"<–∫—Ä–∞—Ç–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä: '–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é CRM-—Å–∏—Å—Ç–µ–º—ã'>\",\n\"items\": [\n{\n\"service_type\": \"<—Ç–∏–ø —É—Å–ª—É–≥–∏: '–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è', '–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ', '—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞' –∏–ª–∏ '–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ'>\",\n\"service_name\": \"<–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ –∏–∑ –ë–î>\",\n\"price\": \"<—Å—Ç–æ–∏–º–æ—Å—Ç—å –∏–∑ –ë–î –∫–∞–∫ –µ—Å—Ç—å>\",\n\"description\": \"<–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞>\"\n}\n],\n\"total_price_comment\": \"<–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏, —ç—Ç–∞–ø–∞–º –∏–ª–∏ —Å–∫–∏–¥–∫–∞–º, –µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ>\"\n}\n\n–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n–û—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø—Ä–æ—Å–∞):\nn8n_chat_histories\n–î–æ—Å—Ç—É–ø–Ω—ã–µ —É—Å–ª—É–≥–∏ –∏–∑ –ë–î (–ø–æ —Ç–∏–ø–∞–º):\ndocuments "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        3520,
        336
      ],
      "id": "aa6a1481-df99-4243-8d03-f8d2c22c3e46",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        3440,
        560
      ],
      "id": "6306f33f-6b16-47e6-8a38-8c4904c3f4a8",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "GW1wqXvW3BLftkCs",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.message.chat.id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        3616,
        624
      ],
      "id": "34023ddf-bd2c-40a0-a89c-0d6dbfcf2c94",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "–ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º —É—Å–ª—É–≥–∞–º",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        3856,
        576
      ],
      "id": "d9a77425-ae53-4e75-a4a5-e40f4aa89713",
      "name": "Supabase Vector Store",
      "credentials": {
        "supabaseApi": {
          "id": "EGZzmk2uRh1d41J0",
          "name": "Supabase account 2"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        3984,
        768
      ],
      "id": "106f5946-acc0-4012-8e6b-81ba0cd9fd79",
      "name": "Embeddings Google Gemini2",
      "credentials": {
        "googlePalmApi": {
          "id": "GW1wqXvW3BLftkCs",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "TRUNCATE TABLE documents RESTART IDENTITY; ",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3360,
        -1088
      ],
      "id": "29e537b1-54ab-4d54-b4e5-e8c823d23eac",
      "name": "Execute a SQL query",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash-lite",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -1664,
        1072
      ],
      "id": "49e1e60e-3683-4673-b1cd-2a95fbfc9410",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "GW1wqXvW3BLftkCs",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢—ã ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –æ—Ç–¥–µ–ª–∞ –ø—Ä–µ—Å–µ–π–ª–∞ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤.\n–í—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: \"{{ $('Telegram Trigger').item.json.message.text }}\"\n–ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π –≤ –û–î–ù–£ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ —Å–ø–∏—Å–∫–∞:\n- no_content ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –±–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–º—ã—Å–ª–∞ (¬´–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ¬ª, ¬´–û–∫¬ª, ¬´–°–ø–∞—Å–∏–±–æ¬ª)\n- service_request ‚Äî —è–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ —É—Å–ª—É–≥—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç, —Ü–µ–Ω—ã, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)\n- answer_to_question ‚Äî –æ—Ç–≤–µ—Ç –Ω–∞ —Ä–∞–Ω–µ–µ –∑–∞–¥–∞–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å (—É—Ç–æ—á–Ω–µ–Ω–∏–µ, –¥–∞–Ω–Ω—ã–µ, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)\n–ü—Ä–∞–≤–∏–ª–∞:\n- –ï—Å–ª–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç—å service_request vs answer_to_question ‚Üí –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç answer_to_question\n- –ò–≥–Ω–æ—Ä–∏—Ä—É–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –ø–æ–¥–ø–∏—Å–∏\n–í–´–í–û–î–ò —Å—Ç—Ä–æ–≥–æ –≤ JSON, –±–µ–∑ —Ç–µ–∫—Å—Ç–∞ –¥–æ/–ø–æ—Å–ª–µ:\n{\n  \"category\": \"no_content|service_request|answer_to_question\",\n  \"explanation\": \"–∫—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤ 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö\"\n}\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -4000,
        448
      ],
      "id": "eebbb80d-06a2-432e-8c3c-7da315f8f8a8",
      "name": "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π"
    },
    {
      "parameters": {
        "jsCode": "const outputString = $input.first().json.output;\n\nlet category = 'parse_error';\n\n// –ù–∞—Ö–æ–¥–∏–º JSON –º–µ–∂–¥—É ``````\nconst jsonStart = outputString.indexOf('{');\nconst jsonEnd = outputString.lastIndexOf('}') + 1;\n\nif (jsonStart !== -1 && jsonEnd > jsonStart) {\n  const jsonString = outputString.substring(jsonStart, jsonEnd);\n  \n  try {\n    const parsed = JSON.parse(jsonString);\n    category = parsed.category || 'no_category';\n  } catch (e) {\n    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É\n  }\n}\n\nreturn [{ json: { category } }];\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3632,
        448
      ],
      "id": "7a7ef0b1-202c-4589-895a-46941f40baa1",
      "name": "–í—ã–Ω–∏–º–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å JSON"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–µ—Å–µ–π–ª—É –∏ –±—Ä–∏—Ñ–æ–≤–∞–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å—Ñ–µ—Ä–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤.\n\n–£ —Ç–µ–±—è –µ—Å—Ç—å:\n- –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞: {{ $('–í—ã–Ω–∏–º–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å JSON').item.json.category }}\n- –°–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ {{ $('Telegram Trigger').first().json.message.text }}\n- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ n8n_chat_histories\n\n–ó–∞–¥–∞—á–∞: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –†–û–í–ù–û –û–î–ò–ù –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–∞.\n\n–ü—Ä–∞–≤–∏–ª–∞:\n- –í–æ–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º, –ø–æ–Ω—è—Ç–Ω—ã–º, –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∂–∞—Ä–≥–æ–Ω–∞\n- –ù–∞—á–∏–Ω–∞–π —Å –æ–±—â–µ–≥–æ, –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –¥–µ—Ç–∞–ª—è–º –ø–æ –º–µ—Ä–µ –¥–∏–∞–ª–æ–≥–∞\n- –£—á–∏—Ç—ã–≤–∞–π –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞\n- –ù–µ –æ—Ç–≤–µ—á–∞–π –∑–∞ –∫–ª–∏–µ–Ω—Ç–∞, –Ω–µ –¥–µ–ª–∞–π –≤—ã–≤–æ–¥–æ–≤\n\n–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: –¢–û–õ–¨–ö–û –≤–æ–ø—Ä–æ—Å –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É\n\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -1968,
        32
      ],
      "id": "01ef7a9f-632c-4521-8a38-21d50f9b6e6d",
      "name": "–ü–æ—á–µ–º—É—á–∫–∞"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').first().json.message.from.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1648,
        32
      ],
      "id": "02942826-1462-4e0a-b5e0-b27abb5e0c1c",
      "name": "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢—ã ‚Äî –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –±—Ä–∏—Ñ–∞/–æ–ø—Ä–æ—Å–∞.\n–ù–∞ –≤—Ö–æ–¥–µ —É —Ç–µ–±—è –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä ¬´–≤–æ–ø—Ä–æ—Å‚Äì–æ—Ç–≤–µ—Ç¬ª.\n\n–¢–≤–æ—è –∑–∞–¥–∞—á–∞ –¥–ª—è –ö–ê–ñ–î–û–ô –ø–∞—Ä—ã ¬´–≤–æ–ø—Ä–æ—Å‚Äì–æ—Ç–≤–µ—Ç¬ª:\n\n–û—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å.\n\n–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Ç–≤–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–ª–∏ –µ–≥–æ –Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å.\n\n–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–¥–∏–Ω —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å.\n\n–û—Ü–µ–Ω–∏–≤–∞–π –æ—Ç–≤–µ—Ç –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –º–µ—Ç—Ä–∏–∫–∞–º (–∫–∞–∂–¥—É—é –ø–æ —à–∫–∞–ª–µ 0‚Äì2):\n\n–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: –ù–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç –ø–æ —Å—É—Ç–∏ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∑–∞–¥–∞–Ω–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É?\n\n0 ‚Äî –ø–æ—á—Ç–∏ –Ω–µ —Å–≤—è–∑–∞–Ω —Å –≤–æ–ø—Ä–æ—Å–æ–º –∏–ª–∏ –æ—Ñ—Ñ—Ç–æ–ø.\n\n1 ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ —Å–≤—è–∑–∞–Ω, –Ω–æ –º–Ω–æ–≥–æ –æ–±—â–∏—Ö —Ñ—Ä–∞–∑.\n\n2 ‚Äî —á—ë—Ç–∫–æ –ø—Ä–æ —Ç–æ, —á—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞–ª–∏.\n\n–ü–æ–ª–Ω–æ—Ç–∞: –ù–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã –≤–æ–ø—Ä–æ—Å–∞?\n\n0 ‚Äî –ø–æ—á—Ç–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ, —Å–∏–ª—å–Ω–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã—Ö.\n\n1 ‚Äî –µ—Å—Ç—å –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ—Ç–∞–ª–µ–π.\n\n2 ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É.\n\n–ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞: –ù–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã, —Ü–∏—Ñ—Ä—ã, –ø—Ä–∏–º–µ—Ä—ã?\n\n0 ‚Äî –æ–±—â–∏–µ —Å–ª–æ–≤–∞ —Ç–∏–ø–∞ ¬´–Ω—É –∫–∞–∫ —É –≤—Å–µ—Ö¬ª, ¬´–Ω–µ –∑–Ω–∞—é¬ª, ¬´–ø—Ä–∏–º–µ—Ä–Ω–æ¬ª.\n\n1 ‚Äî –Ω–µ–º–Ω–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏, –Ω–æ –º–Ω–æ–≥–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ —Ä–∞–∑–º—ã—Ç—ã.\n\n2 ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏: —Ü–∏—Ñ—Ä—ã, –¥–∏–∞–ø–∞–∑–æ–Ω—ã, –ø—Ä–∏–º–µ—Ä—ã, –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.\n\n–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: –ù–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç –Ω–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —Å–µ–±–µ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (–µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å)?\n\n0 ‚Äî –∑–∞–º–µ—Ç–Ω—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–Ω–µ–µ –≥–æ–≤–æ—Ä–∏–ª –æ–¥–Ω–æ, —Ç–µ–ø–µ—Ä—å –¥—Ä—É–≥–æ–µ).\n\n1 ‚Äî –º–µ–ª–∫–∏–µ –Ω–µ—Å–æ—Å—Ç—ã–∫–æ–≤–∫–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω–∞—è —è—Å–Ω–æ—Å—Ç—å.\n\n2 ‚Äî –ª–æ–≥–∏—á–Ω–æ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º.\n\n–ü—Ä–∞–≤–∏–ª–∞ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –û–¢–î–ï–õ–¨–ù–û–ì–û –æ—Ç–≤–µ—Ç–∞:\n\n–°—á–∏—Ç–∞–π –æ—Ç–≤–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º, –µ—Å–ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:\n\n–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å ‚â• 1,\n\n–∏ –ü–æ–ª–Ω–æ—Ç–∞ ‚â• 1,\n\n–∏ –ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞ ‚â• 1.\n\n–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∏–∑ —ç—Ç–∏—Ö —Ç—Ä—ë—Ö –º–µ—Ç—Ä–∏–∫ (–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å, –ü–æ–ª–Ω–æ—Ç–∞, –ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞) = 0, —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ —É—Ç–æ—á–Ω–µ–Ω–∏–∏.\n\n–¢–≤–æ—è –ª–æ–≥–∏–∫–∞:\n\n–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –æ—Ü–µ–Ω–∏ –æ—Ç–≤–µ—Ç –ø–æ —á–µ—Ç—ã—Ä—ë–º –º–µ—Ç—Ä–∏–∫–∞–º.\n\n–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ —É—Ç–æ—á–Ω–µ–Ω–∏–∏, –¥–æ–±–∞–≤—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —ç—Ç–æ–º –≤–æ–ø—Ä–æ—Å–µ –≤ —Å–ø–∏—Å–æ–∫ invalid_questions.\n\n–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, –ù–ï –¥–æ–±–∞–≤–ª—è–π –µ–≥–æ –≤ invalid_questions.\n\n–ù–µ –ø—Ä–∏–¥–∏—Ä–∞–π—Å—è –∫ —Å—Ç–∏–ª—é –∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏, –æ—Ü–µ–Ω–∏–≤–∞–π –ø–æ —Å–º—ã—Å–ª—É.\n\n–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –æ–¥–Ω—É –∫–æ—Ä–æ—Ç–∫—É—é –ø–æ–Ω—è—Ç–Ω—É—é –ø—Ä–∏—á–∏–Ω—É –≤ –ø–æ–ª–µ reason (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–°–ª–∏—à–∫–æ–º –æ–±—â–∏–π –æ—Ç–≤–µ—Ç, –Ω–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ –ø–æ –±—é–¥–∂–µ—Ç—É¬ª –∏–ª–∏ ¬´–û—Ç–≤–µ—Ç –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∑–∞–¥–∞–Ω–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É¬ª).\n\n–§–æ—Ä–º–∞—Ç –ò–¢–û–ì–û–í–û–ì–û –æ—Ç–≤–µ—Ç–∞ (—Å—Ç—Ä–æ–≥–æ JSON):\n\n–ï—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç:\n\njson\n{\n  \"invalid_questions\": [\n    {\n      \"question\": \"<–≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –∑–∞–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç—É –∏–ª–∏ –ò–ò>\",\n      \"answer\": \"<–æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è>\",\n      \"reason\": \"<–ø–æ—á–µ–º—É –æ—Ç–≤–µ—Ç –ø–ª–æ—Ö–æ –ø–æ–¥—Ö–æ–¥–∏—Ç: —á—Ç–æ –≤ –Ω—ë–º –Ω–µ —Ç–∞–∫ –∏–ª–∏ —á–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç>\",\n      \"follow_up_question\": \"<–æ–¥–∏–Ω —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ>\"\n    }\n    // –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–æ–±–∞–≤—å —Å—é–¥–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n  ]\n}\n–ï—Å–ª–∏ –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ (–≤—Å–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç –∫—Ä–∏—Ç–µ—Ä–∏—é –∫–∞—á–µ—Å—Ç–≤–∞):\n\njson\n{\n  \"invalid_questions\": null\n}\n–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n\n–û—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ –±–µ—Ä—É—Ç—Å—è –∏–∑:\n —Ç–∞–±–ª–∏—Ü—ã n8n_chat_histories –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.\n\n–ù–µ –≤—ã–≤–æ–¥–∏ –Ω–∏–∫–∞–∫–∏—Ö –ø–æ—è—Å–Ω–µ–Ω–∏–π, —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤–Ω–µ —É–∫–∞–∑–∞–Ω–Ω–æ–π JSON‚Äë—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -2704,
        672
      ],
      "id": "6990c400-efe8-4b1a-b377-93b29326a3a0",
      "name": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').first().json.message.from.id }}",
        "text": "=",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1952,
        672
      ],
      "id": "b267bb5e-91c0-4625-aa92-e958f49dac93",
      "name": "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const outputString = $input.first().json.output;\n\n// –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± - –±–µ—Ä—ë–º –≤—Å—ë –º–µ–∂–¥—É { –∏ }\nconst start = outputString.indexOf('{');\nconst end = outputString.lastIndexOf('}') + 1;\n\nif (start === -1 || end <= start) {\n  return [{ json: { follow_up_question: '' } }];\n}\n\nconst jsonString = outputString.substring(start, end);\n\ntry {\n  const parsed = JSON.parse(jsonString);\n  \n  if (parsed.invalid_questions && \n      Array.isArray(parsed.invalid_questions) && \n      parsed.invalid_questions.length > 0 &&\n      parsed.invalid_questions[0].follow_up_question) {\n    \n    return [{ json: { \n      follow_up_question: parsed.invalid_questions[0].follow_up_question \n    } }];\n  }\n  \n} catch (e) {\n  // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –ø–∞—Ä—Å–∏–Ω–≥–∞\n}\n\nreturn [{ json: { follow_up_question: '' } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2368,
        672
      ],
      "id": "d1d3f681-7e8d-4541-892c-816b426807da",
      "name": "–í—ã–Ω–∏–º–∞–µ–º —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å —Å JSON"
    },
    {
      "parameters": {
        "model": "xiaomi/mimo-v2-flash:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -1920,
        1232
      ],
      "id": "c04d2e59-6b1b-4578-ac49-b7d3f1b88b36",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "yYPdAf4TZpRumqvi",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET status = '–£—Ç–æ—á–Ω–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π', \n    questions_count = questions_count + 1, \n    last_contact_at = CURRENT_TIMESTAMP \nWHERE order_id = '{{ $('–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤').item.json.order_id }}';\n\n\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1440,
        32
      ],
      "id": "6ed71bad-d4a8-4bdd-90de-b781d8bb990a",
      "name": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "clients",
          "mode": "list",
          "cachedResultName": "clients"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "user_id",
              "value": "={{ $json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -4560,
        976
      ],
      "id": "b0f4be04-32a2-480d-9bb2-06e9719a7523",
      "name": "–ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å –ª–∏ –∫–ª–∏–µ–Ω—Ç –≤ –ë–î",
      "alwaysOutputData": true,
      "notesInFlow": false,
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "7f320443-3a2e-4d02-8f8b-2a9ab538b4b6",
              "leftValue": "={{ $json.user_id }}",
              "rightValue": 0,
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4368,
        976
      ],
      "id": "ddd121f7-4af9-4398-b213-12b072ae265c",
      "name": "–ö–ª–∏–µ–Ω—Ç —É–∂–µ –µ—Å—Ç—å?",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=–î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚¨áÔ∏è",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4176,
        1072
      ],
      "id": "5abac500-a608-461f-8eb3-6f310485dcdb",
      "name": "–ó–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO clients (user_id, name, phone, last_contact_at)\nVALUES (\n    {{ $('Telegram Trigger').item.json.message.chat.id }}, \n    '{{ $('Telegram Trigger').item.json.message.chat.first_name }}',\n    '{{ $json.phone }}',\n    CURRENT_TIMESTAMP\n);\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -4496,
        -400
      ],
      "id": "3ad7f7b5-b64f-4bbe-89d5-5b23ec5a3346",
      "name": "–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "orders",
          "mode": "list",
          "cachedResultName": "orders"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "order_id",
              "value": "={{ $('–î–æ—Å—Ç–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞').first().json.order_id }}"
            }
          ]
        },
        "options": {
          "outputColumns": [
            "questions_count",
            "user_id",
            "order_id"
          ]
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -2704,
        288
      ],
      "id": "0ad8707d-ef53-4798-8041-6d59d6e42f1f",
      "name": "–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "37f262ea-5036-4c99-972a-4d28cccb2bc5",
              "leftValue": "={{ $json.questions_count }}",
              "rightValue": 3,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2496,
        288
      ],
      "id": "f6643ce4-3235-41a6-ae63-15af3a71baa9",
      "name": "–ú–µ–Ω—å—à–µ 3 ?"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6cb56da4-da74-4fb7-8759-9acdb331039a",
              "leftValue": "={{ $json.follow_up_question }}",
              "rightValue": "Null",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2144,
        672
      ],
      "id": "4de83573-cfb3-4713-93d7-e9357a7577f0",
      "name": "–ù–∞–¥–æ —É—Ç–æ—á–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç?"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE clients \nSET last_contact_at = CURRENT_TIMESTAMP\nWHERE user_id = {{ $('Telegram Trigger').item.json.message.chat.id }};\n\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -4176,
        848
      ],
      "id": "916673fd-6272-4e7b-a73d-61059300565e",
      "name": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã –ø–æ—Å–µ—â–µ–Ω–∏—è –≤ clients",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').first().json.message.chat.id }}",
        "text": "=–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏. \n–ù–∞–ø—Ä–∏–º–µ—Ä: \"–ö–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å—á–µ—Ç–æ–≤?\" \n–í–∞—à –∑–∞–ø—Ä–æ—Å?",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -2704,
        480
      ],
      "id": "7b661a8a-a2be-4421-8528-9e5f36b1f2fe",
      "name": "–û—Ç–≤–µ—Ç –Ω–∞ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=\"–ü—Ä–∏–≤–µ—Ç! üòä –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ, –∫–∞–∫—É—é –∑–∞–¥–∞—á—É —Ö–æ—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å?\"\n",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4304,
        -400
      ],
      "id": "72212185-018d-44da-8dc5-07fc7996a0d7",
      "name": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "orders",
          "mode": "list",
          "cachedResultName": "orders"
        },
        "where": {
          "values": [
            {
              "column": "user_id",
              "value": "={{ $('Telegram Trigger').first().json.message.chat.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3968,
        848
      ],
      "id": "430406ea-7ea0-480b-9550-a4c00eaa0d11",
      "name": "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤",
      "alwaysOutputData": true,
      "executeOnce": true,
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç-–æ—Ü–µ–Ω—â–∏–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤, –≤—ã—Å—Ç—É–ø–∞—é—â–∏–π –≤ —Ä–æ–ª–∏ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞. –ê–ù–ê–õ–ò–ó–ò–†–£–ô **–¢–û–õ–¨–ö–û** —Ç–µ–∫—Å—Ç –∏–∑ {{ $json.message.content }}\n\n–í–æ—Ç —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω–∏—Ç—å:\n\n–ü–æ—Å—Ç—Ä–æ–π —Å–≤—è–∑–Ω–æ–µ —Å–∞–º–º–∞—Ä–∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤ (\"summary\") ‚Äî –∫—Ä–∞—Ç–∫–æ, –Ω–æ —ë–º–∫–æ –∏–∑–ª–æ–∂–∏, —á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞, –∫–∞–∫–∏–µ —Ü–µ–ª–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ–Ω –æ–±–æ–∑–Ω–∞—á–∏–ª, –∏ –∫–∞–∫–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã.\n\n**–ó–ê–ü–†–ï–©–ï–ù–û:**\n- –ü—Ä–∏–¥—É–º—ã–≤–∞—Ç—å —Ñ–∞–∫—Ç—ã –ù–ï –ò–ó –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞\n- –î–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥—ã –æ —Å—Ñ–µ—Ä–µ –±–∏–∑–Ω–µ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞ (—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ/—Ä–µ–º–æ–Ω—Ç –∏ —Ç.–ø.)\n- –î–æ–±–∞–≤–ª—è—Ç—å –¥–µ—Ç–∞–ª–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ —Ç–µ–∫—Å—Ç–µ\n\n–û—Ü–µ–Ω–∏ –ø–æ–ª–Ω–æ—Ç—É –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (\"estimateSummary\") ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –∫–ª–∏–µ–Ω—Ç –¥–∞–ª –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—é –¢–ó –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞. –í–µ—Ä–Ω–∏ —á–∏—Å–ª–æ–≤—ã–µ –æ—Ü–µ–Ω–∫–∏ –ø–æ —à–∫–∞–ª–µ –æ—Ç 0 –¥–æ 100 –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º:\nfull: –ø–æ–ª–Ω–æ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞—Å–∫–æ–ª—å–∫–æ –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Ç–æ—á–Ω–µ–Ω–æ);\npractice: –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π (–¥–∏–∑–∞–π–Ω, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, API –∏ —Ç. –ø.);\nplanning: –µ—Å—Ç—å –ª–∏ —á—ë—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤, —Å—Ä–æ–∫–æ–≤, –±—é–¥–∂–µ—Ç–∞;\nundefined: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–µ–π –∏–ª–∏ —Ä–∞–∑–º—ã—Ç—ã—Ö —Ç–æ—á–µ–∫ (0 ‚Äî –≤—Å—ë —è—Å–Ω–æ, 100 ‚Äî –º–Ω–æ–≥–æ –Ω–µ—è—Å–Ω–æ—Å—Ç–µ–π).\n\n–í–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –±–ª–æ–∫–∞ –¥–æ–±–∞–≤—å –∫—Ä–∞—Ç–∫–∏–π —Ç–µ–∫—Å—Ç –∞–Ω–∞–ª–∏–∑–∞ (2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º, —á–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–ª—è —Å—Ç–∞—Ä—Ç–∞.\n–û—Ü–µ–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (\"estimateProjectDifficulty\") ‚Äî –æ—Ü–µ–Ω–∏ –ø—Ä–æ–µ–∫—Ç –ø–æ —Ç—Ä—ë–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º (0‚Äì100):\nteam: —Ç—Ä–µ–±—É–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–º–∞–Ω–¥—ã (—á–µ–º –≤—ã—à–µ ‚Äî —Ç–µ–º –±–æ–ª—å—à–µ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã –∏ —Ä–æ–ª–µ–π –Ω—É–∂–Ω–æ);\nhighload: –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (–Ω–∞–≥—Ä—É–∑–∫–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å);\nbudg: –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–∞—è –±—é–¥–∂–µ—Ç–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (—á–µ–º –≤—ã—à–µ ‚Äî —Ç–µ–º –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è).\n–í –∫–æ–Ω—Ü–µ —Ä–∞—Å—Å—á–∏—Ç–∞–π –∏—Ç–æ–≥–æ–≤—É—é –æ—Ü–µ–Ω–∫—É –æ–±—â–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Å—Ç–∞—Ä—Ç—É –ø–æ 100-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –≤—ã—à–µ). –î–æ–±–∞–≤—å –ø–æ–ª–µ totalScore –≤ –∫–æ—Ä–µ–Ω—å JSON.\n–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ —Å—Ç—Ä–æ–≥–æ –≤ JSON:\n{\"summary\": \"<Text>\",\"estimateSummary\": {\"analysis\": \"<Text>\",\"full\": <0-100>,\"practice\": <0-100>,\"planning\": <0-100>,\"undefined\": <0-100>},\"estimateProjectDifficulty\": {\"team\": <0-100>,\"highload\": <0-100>,\"budg\": <0-100>},\"totalScore\": <0-100>}\n\n–ü–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º —É–±–µ–¥–∏—Å—å, —á—Ç–æ –≤—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π –≤–Ω–µ JSON. –î–æ–±–∞–≤—å —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ.\n## –ü–†–ò–ú–ï–† –¢–û–ß–ù–û–ì–û –§–û–†–ú–ê–¢–ê:\n{\n    \"summary\": \"–ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç Telegram –±–æ—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–∞–ø—á–∞—Å—Ç–µ–π\",\n    \"estimateSummary\": {\n        \"analysis\": \"–•–≤–∞—Ç–∞–µ—Ç API –∏ —Å—Ö–µ–º—ã –ë–î, –Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω\",\n        \"full\": 85,\n        \"practice\": 90,\n        \"planning\": 60,\n        \"undefined\": 20\n    },\n    \"estimateProjectDifficulty\": {\n        \"team\": 70,\n        \"highload\": 65,\n        \"budg\": 50\n    },\n    \"totalScore\": 72\n}\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -1760,
        432
      ],
      "id": "cd5ffcb8-817a-4e41-98dc-334524531c3c",
      "name": "–û—Ü–µ–Ω—â–∏–∫",
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "n8n_chat_histories",
          "mode": "list",
          "cachedResultName": "n8n_chat_histories"
        },
        "where": {
          "values": [
            {
              "column": "session_id",
              "value": "={{ $json.order_id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1952,
        432
      ],
      "id": "cd1ea8af-c758-47c6-86e1-5794c959813f",
      "name": "–î–æ—Å—Ç–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "function extractTotalScore(output) {\n  try {\n    const jsonStr = output\n      .replace(/``````/g, '')\n      .trim();\n    return JSON.parse(jsonStr).totalScore;\n  } catch (e) {\n    const match = output.match(/\"totalScore\":\\s*(\\d+)/);\n    return match ? parseInt(match[1]) : 0;\n  }\n}\n\n// –í n8n Code Node\nreturn items.map(item => ({\n  json: {\n    ...item.json,\n    total_score: extractTotalScore(item.json.output)  // –æ–¥–Ω–æ –∏–º—è!\n  }\n}));\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1232,
        432
      ],
      "id": "60214ba8-6798-459e-b9ed-eaa60a22b837",
      "name": "–î–æ—Å—Ç–∞–µ–º —á–∏—Å–ª–æ –æ—Ü–µ–Ω–∫–∏"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ef4e7800-9766-4a38-bf69-cb891a2dc366",
              "leftValue": "={{ $json.total_score }}",
              "rightValue": 70,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1040,
        432
      ],
      "id": "80e52bb9-2213-40d4-b1f9-70b19bd75b63",
      "name": "–ë–æ–ª—å—à–µ 70 ?"
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "natalikarpova13@gmail.com",
          "mode": "list",
          "cachedResultName": "natalikarpova13@gmail.com"
        },
        "timeMax": "={{ $now.plus({ days: 7 }) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        -464,
        528
      ],
      "id": "bc9e89c2-ed81-4ca1-b8d8-06c204aabbe1",
      "name": "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π",
      "alwaysOutputData": true,
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "KDbMATZgClDhSOFs",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–ª—É—á–∞–µ–º —Å–æ–±—ã—Ç–∏—è –∏–∑ Google Calendar –Ω–æ–¥—ã\nconst events = $input.all().flatMap(item => item.json.items || item.json);\n\n// ‚úÖ –ü–æ–ª—É—á–∞–µ–º order_id –∏–∑ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏\nconst orderId = $('–î–æ—Å—Ç–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞').first().json.order_id;\n\n// –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (—Å–ª–µ–¥—É—é—â–∏–µ 5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π, –Ω–∞—á–∏–Ω–∞—è —Å –∑–∞–≤—Ç—Ä–∞)\nconst today = new Date();\ntoday.setHours(0, 0, 0, 0);\nconst startDate = new Date(today);\nstartDate.setDate(startDate.getDate() + 1); // –ù–∞—á–∏–Ω–∞–µ–º —Å –∑–∞–≤—Ç—Ä–∞\n\nconst endDate = new Date(today);\nendDate.setDate(endDate.getDate() + 7);\n\nconst workingHours = { start: 15, end: 18 };\nconst slotDuration = 30;\n\nconst freeSlots = [];\n\nfor (let date = new Date(startDate); date <= endDate; date.setDate(date.getDate() + 1)) {\n  const day = date.getDay();\n  \n  // –ë—É–¥–Ω–∏: –ü–Ω-–ü—Ç (1-5)\n  if (day === 0 || day === 6) continue;\n  \n  const dateStr = date.toISOString().split('T')[0];\n  const dayNames = ['–í—Å', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];\n  \n  // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è –∫–Ω–æ–ø–æ–∫: 31.12\n  const formattedDate = dateStr.split('-').reverse().join('.');\n  \n  // –°–ª–æ—Ç—ã –ø–æ 30 –º–∏–Ω\n  for (let hour = workingHours.start; hour < workingHours.end; hour++) {\n    for (let minute = 0; minute < 60; minute += slotDuration) {\n      const slotStartStr = `${dateStr}T${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}:00+03:00`;\n      const slotEndStr = `${dateStr}T${(hour + (minute + slotDuration) / 60).toString().padStart(2, '0')}:${\n        ((minute + slotDuration) % 60).toString().padStart(2, '0')\n      }:00+03:00`;\n      \n      const slotStart = new Date(slotStartStr);\n      const slotEnd = new Date(slotEndStr);\n      \n      const isFree = !events.some(event => {\n        if (!event.start?.dateTime || !event.end?.dateTime) return false;\n        const eventStart = event.start.dateTime;\n        const eventEnd = event.end.dateTime;\n        return slotStartStr < eventEnd && slotEndStr > eventStart;\n      });\n      \n      if (isFree) {\n        freeSlots.push({\n          date: dateStr,\n          formattedDate,  // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–∞—Ç—É\n          time: `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`,\n          dayOfWeek: dayNames[day],\n          slotStart: slotStartStr,\n          slotEnd: slotEndStr\n        });\n      }\n    }\n  }\n}\n\n// –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –¥–Ω—è–º\nconst slotsByDay = {};\nfreeSlots.forEach(slot => {\n  if (!slotsByDay[slot.date]) slotsByDay[slot.date] = [];\n  slotsByDay[slot.date].push(slot);\n});\n\nObject.keys(slotsByDay).sort().forEach(date => {\n  slotsByDay[date].sort((a, b) => a.time.localeCompare(b.time));\n});\n\nconst chatId = $('Telegram Trigger').first().json.message?.chat?.id || \n               $('–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ').first().json.result?.chat?.id || null;\n\n// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –±–ª–æ–∫ –∫–Ω–æ–ø–æ–∫ —Å –î–ê–¢–û–ô –∏ order_id\nconst inlineKeyboard = [];\nconst sortedDates = Object.keys(slotsByDay).sort();\nlet totalDays = 0;\n\nfor (let i = 0; i < sortedDates.length && totalDays < 5; i++) {\n  const date = sortedDates[i];\n  const daySlots = slotsByDay[date];\n  \n  if (daySlots.length > 0) {\n    const dayName = daySlots[0].dayOfWeek;\n    const formattedDate = daySlots[0].formattedDate; // ‚úÖ –ë–µ—Ä–µ–º –¥–∞—Ç—É –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—Ç–∞\n    \n    // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–ª–æ—Ç–æ–≤ —ç—Ç–æ–≥–æ –¥–Ω—è (–≥—Ä—É–ø–ø—ã –ø–æ 2-3)\n    for (let j = 0; j < daySlots.length; j += 3) {\n      const row = daySlots.slice(j, j + 3).map(slot => ({\n        text: `${dayName} ${formattedDate} ${slot.time}`, // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –¥–∞—Ç—É –≤ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏\n        callback_data: `book_${orderId}_${slot.date}_${slot.time.replace(':', '-')}` // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ order_id\n      }));\n      inlineKeyboard.push(row);\n    }\n    \n    totalDays++;\n    \n    if (totalDays < 5 && i < sortedDates.length - 1) {\n      inlineKeyboard.push([{ text: \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\", callback_data: \"ignore\" }]);\n    }\n  }\n}\n\nconst telegramMessage = `üìÖ **–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å –∏ –≤—Ä–µ–º—è –∫–æ–≥–¥–∞ –≤–∞–º —É–¥–æ–±–Ω–æ —Å–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è:**\\n\\n`;\n\nconst telegramBodyString = JSON.stringify({\n  chat_id: chatId,\n  text: telegramMessage,\n  reply_markup: {\n    inline_keyboard: inlineKeyboard\n  },\n  parse_mode: \"Markdown\"\n}, null, 2);\n\nconst result = {\n  chat_id: chatId,\n  orderId,  // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç\n  totalDays,\n  totalFreeSlots: freeSlots.length,\n  totalPossibleSlots: totalDays * 6,\n  freeDays: Object.keys(slotsByDay).slice(0, 5),\n  \n  telegramBodyString, \n  telegramBody: {\n    chat_id: chatId,\n    text: telegramMessage,\n    reply_markup: {\n      inline_keyboard: inlineKeyboard\n    },\n    parse_mode: \"Markdown\"\n  },\n  \n  inlineKeyboard,\n  messagePreview: telegramMessage,\n  \n  debug: {\n    totalEvents: events.length,\n    orderIdFound: !!orderId,\n    orderIdValue: orderId,\n    checkedDates: sortedDates.slice(0, 5),\n    generatedButtons: inlineKeyboard.length,\n    chatIdFound: !!chatId,\n    chatIdValue: chatId\n  }\n};\n\nreturn [{ json: result }];\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -272,
        528
      ],
      "id": "2d522de0-dbca-41da-bbe1-c281b52850c3",
      "name": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)"
    },
    {
      "parameters": {
        "jsCode": "// –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\nconst phoneRaw = $input.first().json.message.text || $input.first().json.message.contact?.phone_number || '';\n\nconst phoneClean = phoneRaw\n  .replace(/[^\\d]/g, '')  // –£–¥–∞–ª—è–µ–º –≤—Å—ë –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä\n  .replace(/^8/, '7');    // –ú–µ–Ω—è–µ–º 8 –Ω–∞ 7 –≤ –Ω–∞—á–∞–ª–µ (—Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç)\n\nreturn [{\n  json: {\n    phone: phoneClean  // \"79111111111\"\n  }\n}];\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4688,
        -400
      ],
      "id": "e624b378-c365-4a60-8ac3-2c67d76150e3",
      "name": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏"
    },
    {
      "parameters": {
        "resource": "calendar",
        "calendar": {
          "__rl": true,
          "value": "natalikarpova13@gmail.com",
          "mode": "list",
          "cachedResultName": "natalikarpova13@gmail.com"
        },
        "timeMin": "={{ $json.startTime }}",
        "timeMax": "={{ $json.endTime }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        -4496,
        -16
      ],
      "id": "ec1d0de1-188b-4aef-b12a-3b3275cde2a2",
      "name": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ –ª–∏ –≤—Ä–µ–º—è",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "KDbMATZgClDhSOFs",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "natalikarpova13@gmail.com",
          "mode": "list",
          "cachedResultName": "natalikarpova13@gmail.com"
        },
        "start": "={{ $('–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏').item.json.startTime }}",
        "end": "={{ $('–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏').item.json.endTime }}",
        "additionalFields": {
          "summary": "=–í—Å—Ç—Ä–µ—á–∞ –ø–æ –∑–∞–∫–∞–∑—É:{{ $('–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏').item.json.orderId }}  {{ $('–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏').item.json.startTime }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        -4112,
        -128
      ],
      "id": "ed3cf0c6-ffe6-40ef-89b4-e34304651caf",
      "name": "–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "KDbMATZgClDhSOFs",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "d739e784-8424-4db4-b9d9-5561fa91ce56",
              "leftValue": "={{ $json.available }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4304,
        -16
      ],
      "id": "a9cc22db-8d0c-4288-939d-e1f6b63adbcd",
      "name": "–í—Ä–µ–º—è —Å–≤–æ–±–æ–¥–Ω–æ?"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').first().json.callback_query.message.chat.id }}",
        "text": "=‚ùå –ò–∑–≤–∏–Ω–∏—Ç–µ, {{ $json.formatted }} —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–Ω—è–ª–∏.\n–í—ã–±–µ—Ä–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è.\n",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3920,
        80
      ],
      "id": "b687b580-f792-4947-b10e-780679a4065d",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot8074937111:AAE3lcd2-HQ9zPX3o0dbwvcRCeunkZ4-nl4/sendMessage",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type ",
              "value": "\"application/json\""
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.telegramBody }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -80,
        528
      ],
      "id": "cdc51ad6-ae66-43b1-abf4-1ed3c5dcbcd0",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–ª–æ—Ç–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏"
    },
    {
      "parameters": {
        "jsCode": "// –ò–∑ callback_query.data: \"book_92773b31-4c39-4149-ad95-c2f9ea9fa67f_2026-01-06_17-30\"\nconst callbackData = $input.first().json.callback_query.data;\nconst [, orderId, date, time] = callbackData.match(/book_([^_]+)_(\\d{4}-\\d{2}-\\d{2})_(\\d{2}-\\d{2})/);\n\nconst startHour = parseInt(time.split('-')[0]);\nconst startMinute = parseInt(time.split('-')[1]);\n\n// –î–æ–±–∞–≤–ª—è–µ–º 30 –º–∏–Ω—É—Ç\nlet endMinute = startMinute + 30;\nlet endHour = startHour;\nif (endMinute >= 60) {\n  endMinute -= 60;\n  endHour += 1;\n}\n\nconst startTime = `${date}T${startHour.toString().padStart(2, '0')}:${startMinute.toString().padStart(2, '0')}:00+03:00`;\nconst endTime = `${date}T${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}:00+03:00`;\n\nreturn [{ \n  json: { \n    orderId,        // \"92773b31-4c39-4149-ad95-c2f9ea9fa67f\"\n    startTime,      // \"2026-01-06T17:30:00+03:00\"\n    endTime         // \"2026-01-06T18:00:00+03:00\"\n  } \n}];\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4688,
        -16
      ],
      "id": "4756a207-5a95-4cbd-8617-c2b33ff7d744",
      "name": "–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏"
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "natalikarpova13@gmail.com",
          "mode": "list",
          "cachedResultName": "natalikarpova13@gmail.com"
        },
        "timeMax": "={{ $now.plus({ days: 7 }) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        -3712,
        80
      ],
      "id": "5c77a92d-1d86-4372-a681-568bcd3aaa3a",
      "name": "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π1",
      "alwaysOutputData": true,
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "KDbMATZgClDhSOFs",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–ª—É—á–∞–µ–º —Å–æ–±—ã—Ç–∏—è –∏–∑ Google Calendar –Ω–æ–¥—ã\nconst events = $input.all().flatMap(item => item.json.items || item.json);\n\n// ‚úÖ –ü–æ–ª—É—á–∞–µ–º order_id –∏–∑ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏\nconst orderId = $input.first().json.order_id;\n\n// –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (—Å–ª–µ–¥—É—é—â–∏–µ 5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π, –Ω–∞—á–∏–Ω–∞—è —Å –∑–∞–≤—Ç—Ä–∞)\nconst today = new Date();\ntoday.setHours(0, 0, 0, 0);\nconst startDate = new Date(today);\nstartDate.setDate(startDate.getDate() + 1); // –ù–∞—á–∏–Ω–∞–µ–º —Å –∑–∞–≤—Ç—Ä–∞\n\nconst endDate = new Date(today);\nendDate.setDate(endDate.getDate() + 7);\n\nconst workingHours = { start: 15, end: 18 };\nconst slotDuration = 30;\n\nconst freeSlots = [];\n\nfor (let date = new Date(startDate); date <= endDate; date.setDate(date.getDate() + 1)) {\n  const day = date.getDay();\n  \n  // –ë—É–¥–Ω–∏: –ü–Ω-–ü—Ç (1-5)\n  if (day === 0 || day === 6) continue;\n  \n  const dateStr = date.toISOString().split('T')[0];\n  const dayNames = ['–í—Å', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];\n  \n  // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è –∫–Ω–æ–ø–æ–∫: 31.12\n  const formattedDate = dateStr.split('-').reverse().join('.');\n  \n  // –°–ª–æ—Ç—ã –ø–æ 30 –º–∏–Ω\n  for (let hour = workingHours.start; hour < workingHours.end; hour++) {\n    for (let minute = 0; minute < 60; minute += slotDuration) {\n      const slotStartStr = `${dateStr}T${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}:00+03:00`;\n      const slotEndStr = `${dateStr}T${(hour + (minute + slotDuration) / 60).toString().padStart(2, '0')}:${\n        ((minute + slotDuration) % 60).toString().padStart(2, '0')\n      }:00+03:00`;\n      \n      const slotStart = new Date(slotStartStr);\n      const slotEnd = new Date(slotEndStr);\n      \n      const isFree = !events.some(event => {\n        if (!event.start?.dateTime || !event.end?.dateTime) return false;\n        const eventStart = event.start.dateTime;\n        const eventEnd = event.end.dateTime;\n        return slotStartStr < eventEnd && slotEndStr > eventStart;\n      });\n      \n      if (isFree) {\n        freeSlots.push({\n          date: dateStr,\n          formattedDate,  // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–∞—Ç—É\n          time: `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`,\n          dayOfWeek: dayNames[day],\n          slotStart: slotStartStr,\n          slotEnd: slotEndStr\n        });\n      }\n    }\n  }\n}\n\n// –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –¥–Ω—è–º\nconst slotsByDay = {};\nfreeSlots.forEach(slot => {\n  if (!slotsByDay[slot.date]) slotsByDay[slot.date] = [];\n  slotsByDay[slot.date].push(slot);\n});\n\nObject.keys(slotsByDay).sort().forEach(date => {\n  slotsByDay[date].sort((a, b) => a.time.localeCompare(b.time));\n});\n\nconst chatId = $('Telegram Trigger').first().json.message?.chat?.id || \n               $('–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ').first().json.result?.chat?.id || null;\n\n// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –±–ª–æ–∫ –∫–Ω–æ–ø–æ–∫ —Å –î–ê–¢–û–ô –∏ order_id\nconst inlineKeyboard = [];\nconst sortedDates = Object.keys(slotsByDay).sort();\nlet totalDays = 0;\n\nfor (let i = 0; i < sortedDates.length && totalDays < 5; i++) {\n  const date = sortedDates[i];\n  const daySlots = slotsByDay[date];\n  \n  if (daySlots.length > 0) {\n    const dayName = daySlots[0].dayOfWeek;\n    const formattedDate = daySlots[0].formattedDate; // ‚úÖ –ë–µ—Ä–µ–º –¥–∞—Ç—É –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—Ç–∞\n    \n    // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–ª–æ—Ç–æ–≤ —ç—Ç–æ–≥–æ –¥–Ω—è (–≥—Ä—É–ø–ø—ã –ø–æ 2-3)\n    for (let j = 0; j < daySlots.length; j += 3) {\n      const row = daySlots.slice(j, j + 3).map(slot => ({\n        text: `${dayName} ${formattedDate} ${slot.time}`, // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –¥–∞—Ç—É –≤ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏\n        callback_data: `book_${orderId}_${slot.date}_${slot.time.replace(':', '-')}` // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ order_id\n      }));\n      inlineKeyboard.push(row);\n    }\n    \n    totalDays++;\n    \n    if (totalDays < 5 && i < sortedDates.length - 1) {\n      inlineKeyboard.push([{ text: \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\", callback_data: \"ignore\" }]);\n    }\n  }\n}\n\nconst telegramMessage = `üìÖ **–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å –∏ –≤—Ä–µ–º—è –∫–æ–≥–¥–∞ –≤–∞–º —É–¥–æ–±–Ω–æ —Å–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è:**\\n\\n`;\n\nconst telegramBodyString = JSON.stringify({\n  chat_id: chatId,\n  text: telegramMessage,\n  reply_markup: {\n    inline_keyboard: inlineKeyboard\n  },\n  parse_mode: \"Markdown\"\n}, null, 2);\n\nconst result = {\n  chat_id: chatId,\n  orderId,  // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç\n  totalDays,\n  totalFreeSlots: freeSlots.length,\n  totalPossibleSlots: totalDays * 6,\n  freeDays: Object.keys(slotsByDay).slice(0, 5),\n  \n  telegramBodyString, \n  telegramBody: {\n    chat_id: chatId,\n    text: telegramMessage,\n    reply_markup: {\n      inline_keyboard: inlineKeyboard\n    },\n    parse_mode: \"Markdown\"\n  },\n  \n  inlineKeyboard,\n  messagePreview: telegramMessage,\n  \n  debug: {\n    totalEvents: events.length,\n    orderIdFound: !!orderId,\n    orderIdValue: orderId,\n    checkedDates: sortedDates.slice(0, 5),\n    generatedButtons: inlineKeyboard.length,\n    chatIdFound: !!chatId,\n    chatIdValue: chatId\n  }\n};\n\nreturn [{ json: result }];\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3520,
        80
      ],
      "id": "ced1e35e-2184-405d-86e9-077f694080ba",
      "name": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot8074937111:AAE3lcd2-HQ9zPX3o0dbwvcRCeunkZ4-nl4/sendMessage",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type ",
              "value": "\"application/json\""
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.telegramBody }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -3328,
        80
      ],
      "id": "a18762d2-3fc5-4623-bdf5-efd81330075d",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–ª–æ—Ç–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏1"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET status = '–û–∂–∏–¥–∞–µ—Ç –≤—Å—Ç—Ä–µ—á–∏ —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º'\nWHERE order_id = '{{ $('–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏').item.json.orderId }}';\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3728,
        -128
      ],
      "id": "388d9344-615e-4bb5-b06c-7d96e38e85fd",
      "name": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞3",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.callback_query.message.chat.id }}",
        "text": "=–í–∞—à–∞ –≤—Å—Ç—Ä–µ—á–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ {{ $json.formatted }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3344,
        -128
      ],
      "id": "be84357a-07af-4e9c-93f8-fdf8368f9b88",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Å—Ç—Ä–µ—á–∞ —Å–æ–∑–¥–∞–Ω–∞",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const isoDate = $('–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏')\n  .first()\n  .json\n  .startTime;\n\n// –ë–µ—Ä—ë–º ¬´—Å—ã—Ä—ã–µ¬ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –ø–æ UTC\nconst date = new Date(isoDate);\n\nconst months = [\n  \"—è–Ω–≤–∞—Ä—è\", \"—Ñ–µ–≤—Ä–∞–ª—è\", \"–º–∞—Ä—Ç–∞\", \"–∞–ø—Ä–µ–ª—è\", \"–º–∞—è\", \"–∏—é–Ω—è\",\n  \"–∏—é–ª—è\", \"–∞–≤–≥—É—Å—Ç–∞\", \"—Å–µ–Ω—Ç—è–±—Ä—è\", \"–æ–∫—Ç—è–±—Ä—è\", \"–Ω–æ—è–±—Ä—è\", \"–¥–µ–∫–∞–±—Ä—è\"\n];\n\n// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–º–µ–Ω–Ω–æ —Ç–æ –≤—Ä–µ–º—è, —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ (+03:00), —Ç–æ\n// –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ —Å–¥–≤–∏–Ω—É—Ç—å —á–∞—Å—ã —Å —É—á—ë—Ç–æ–º —Å–º–µ—â–µ–Ω–∏—è:\n\n// 1) –ø–æ–ª—É—á–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ –≤ –º–∏–Ω—É—Ç–∞—Ö (–¥–ª—è +03:00 –±—É–¥–µ—Ç -180)\nconst offsetMinutes = date.getTimezoneOffset(); \n// 2) –ø—Ä–∏–±–∞–≤–ª—è–µ–º 3 —á–∞—Å–∞ (180 –º–∏–Ω—É—Ç) –∫ UTC-–≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å +03\nconst fixedTime = new Date(date.getTime() + (3 * 60 + offsetMinutes) * 60 * 1000);\n\nconst day = fixedTime.getDate();\nconst month = months[fixedTime.getMonth()];\nconst hours = fixedTime.getHours();\nconst minutes = fixedTime.getMinutes().toString().padStart(2, '0');\n\nconst result = `${day} ${month} –≤ ${hours}:${minutes}`;\n\nreturn [{\n  json: { formatted: result }\n}];\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3536,
        -128
      ],
      "id": "9f424855-ed8b-4b21-8333-b61ff1128f44",
      "name": "–ü–µ—Ä–µ–≤–æ–¥ –¥–∞—Ç—ã –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç"
    },
    {
      "parameters": {
        "path": "2ef18949-666c-4741-a7e9-c89b80ea7943",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -464,
        336
      ],
      "id": "cab9ce17-3c82-4f80-bee5-2130c236303c",
      "name": "Webhook –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏",
      "webhookId": "2ef18949-666c-4741-a7e9-c89b80ea7943"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET status = '–ó–∞–¥–∞—á–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞'\nWHERE order_id = '{{ $('Code in JavaScript').item.json.order_id }}';\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        304,
        240
      ],
      "id": "7500efb4-7458-4fef-837b-ed44c5561f9f",
      "name": "–°—Ç–∞—Ç—É—Å = –ó–∞–¥–∞—á–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET status = '–ó–∞–¥–∞—á–∞ –Ω–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞'\nWHERE order_id = '{{ $('Code in JavaScript').item.json.order_id }}';\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        304,
        432
      ],
      "id": "95c9741d-b809-4a36-afd6-202e97386ec0",
      "name": "–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑ = –ó–∞–¥–∞—á–∞ –Ω–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "natalikarpova13@gmail.com",
          "mode": "list",
          "cachedResultName": "natalikarpova13@gmail.com"
        },
        "timeMax": "={{ $now.plus({ days: 7 }) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        496,
        432
      ],
      "id": "7f91f17f-0bfd-4a8e-944d-640d996a4e27",
      "name": "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π2",
      "alwaysOutputData": true,
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "KDbMATZgClDhSOFs",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–ª—É—á–∞–µ–º —Å–æ–±—ã—Ç–∏—è –∏–∑ Google Calendar –Ω–æ–¥—ã\nconst events = $input.all().flatMap(item => item.json.items || item.json);\n\n// ‚úÖ –ü–æ–ª—É—á–∞–µ–º order_id –∏–∑ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏\nconst orderId = $input.first().json.order_id;\n\n// –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (—Å–ª–µ–¥—É—é—â–∏–µ 5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π, –Ω–∞—á–∏–Ω–∞—è —Å –∑–∞–≤—Ç—Ä–∞)\nconst today = new Date();\ntoday.setHours(0, 0, 0, 0);\nconst startDate = new Date(today);\nstartDate.setDate(startDate.getDate() + 1); // –ù–∞—á–∏–Ω–∞–µ–º —Å –∑–∞–≤—Ç—Ä–∞\n\nconst endDate = new Date(today);\nendDate.setDate(endDate.getDate() + 7);\n\nconst workingHours = { start: 15, end: 18 };\nconst slotDuration = 30;\n\nconst freeSlots = [];\n\nfor (let date = new Date(startDate); date <= endDate; date.setDate(date.getDate() + 1)) {\n  const day = date.getDay();\n  \n  // –ë—É–¥–Ω–∏: –ü–Ω-–ü—Ç (1-5)\n  if (day === 0 || day === 6) continue;\n  \n  const dateStr = date.toISOString().split('T')[0];\n  const dayNames = ['–í—Å', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];\n  \n  // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è –∫–Ω–æ–ø–æ–∫: 31.12\n  const formattedDate = dateStr.split('-').reverse().join('.');\n  \n  // –°–ª–æ—Ç—ã –ø–æ 30 –º–∏–Ω\n  for (let hour = workingHours.start; hour < workingHours.end; hour++) {\n    for (let minute = 0; minute < 60; minute += slotDuration) {\n      const slotStartStr = `${dateStr}T${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}:00+03:00`;\n      const slotEndStr = `${dateStr}T${(hour + (minute + slotDuration) / 60).toString().padStart(2, '0')}:${\n        ((minute + slotDuration) % 60).toString().padStart(2, '0')\n      }:00+03:00`;\n      \n      const slotStart = new Date(slotStartStr);\n      const slotEnd = new Date(slotEndStr);\n      \n      const isFree = !events.some(event => {\n        if (!event.start?.dateTime || !event.end?.dateTime) return false;\n        const eventStart = event.start.dateTime;\n        const eventEnd = event.end.dateTime;\n        return slotStartStr < eventEnd && slotEndStr > eventStart;\n      });\n      \n      if (isFree) {\n        freeSlots.push({\n          date: dateStr,\n          formattedDate,  // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–∞—Ç—É\n          time: `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`,\n          dayOfWeek: dayNames[day],\n          slotStart: slotStartStr,\n          slotEnd: slotEndStr\n        });\n      }\n    }\n  }\n}\n\n// –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –¥–Ω—è–º\nconst slotsByDay = {};\nfreeSlots.forEach(slot => {\n  if (!slotsByDay[slot.date]) slotsByDay[slot.date] = [];\n  slotsByDay[slot.date].push(slot);\n});\n\nObject.keys(slotsByDay).sort().forEach(date => {\n  slotsByDay[date].sort((a, b) => a.time.localeCompare(b.time));\n});\n\nconst chatId = $('Telegram Trigger').first().json.message?.chat?.id || \n               $('–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ').first().json.result?.chat?.id || null;\n\n// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –±–ª–æ–∫ –∫–Ω–æ–ø–æ–∫ —Å –î–ê–¢–û–ô –∏ order_id\nconst inlineKeyboard = [];\nconst sortedDates = Object.keys(slotsByDay).sort();\nlet totalDays = 0;\n\nfor (let i = 0; i < sortedDates.length && totalDays < 5; i++) {\n  const date = sortedDates[i];\n  const daySlots = slotsByDay[date];\n  \n  if (daySlots.length > 0) {\n    const dayName = daySlots[0].dayOfWeek;\n    const formattedDate = daySlots[0].formattedDate; // ‚úÖ –ë–µ—Ä–µ–º –¥–∞—Ç—É –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—Ç–∞\n    \n    // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–ª–æ—Ç–æ–≤ —ç—Ç–æ–≥–æ –¥–Ω—è (–≥—Ä—É–ø–ø—ã –ø–æ 2-3)\n    for (let j = 0; j < daySlots.length; j += 3) {\n      const row = daySlots.slice(j, j + 3).map(slot => ({\n        text: `${dayName} ${formattedDate} ${slot.time}`, // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –¥–∞—Ç—É –≤ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏\n        callback_data: `book_${orderId}_${slot.date}_${slot.time.replace(':', '-')}` // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ order_id\n      }));\n      inlineKeyboard.push(row);\n    }\n    \n    totalDays++;\n    \n    if (totalDays < 5 && i < sortedDates.length - 1) {\n      inlineKeyboard.push([{ text: \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\", callback_data: \"ignore\" }]);\n    }\n  }\n}\n\nconst telegramMessage = `üìÖ **–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å –∏ –≤—Ä–µ–º—è –∫–æ–≥–¥–∞ –≤–∞–º —É–¥–æ–±–Ω–æ —Å–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è:**\\n\\n`;\n\nconst telegramBodyString = JSON.stringify({\n  chat_id: chatId,\n  text: telegramMessage,\n  reply_markup: {\n    inline_keyboard: inlineKeyboard\n  },\n  parse_mode: \"Markdown\"\n}, null, 2);\n\nconst result = {\n  chat_id: chatId,\n  orderId,  // ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç\n  totalDays,\n  totalFreeSlots: freeSlots.length,\n  totalPossibleSlots: totalDays * 6,\n  freeDays: Object.keys(slotsByDay).slice(0, 5),\n  \n  telegramBodyString, \n  telegramBody: {\n    chat_id: chatId,\n    text: telegramMessage,\n    reply_markup: {\n      inline_keyboard: inlineKeyboard\n    },\n    parse_mode: \"Markdown\"\n  },\n  \n  inlineKeyboard,\n  messagePreview: telegramMessage,\n  \n  debug: {\n    totalEvents: events.length,\n    orderIdFound: !!orderId,\n    orderIdValue: orderId,\n    checkedDates: sortedDates.slice(0, 5),\n    generatedButtons: inlineKeyboard.length,\n    chatIdFound: !!chatId,\n    chatIdValue: chatId\n  }\n};\n\nreturn [{ json: result }];\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        688,
        432
      ],
      "id": "d38028e2-4455-439e-8400-1bb81aa89ffa",
      "name": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot8074937111:AAE3lcd2-HQ9zPX3o0dbwvcRCeunkZ4-nl4/sendMessage",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type ",
              "value": "\"application/json\""
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.telegramBody }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        880,
        432
      ],
      "id": "84a2a30b-5f6f-4b41-a705-379e33100202",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–ª–æ—Ç–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏2"
    },
    {
      "parameters": {
        "updates": [
          "*"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -5664,
        784
      ],
      "id": "7431accd-f8ae-4be0-bd85-99e07b04c5a2",
      "name": "Telegram Trigger",
      "webhookId": "494cae93-0727-4764-bd3d-4d530e3b8bcf",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot8074937111:AAE3lcd2-HQ9zPX3o0dbwvcRCeunkZ4-nl4/sendMessage",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type ",
              "value": "\"application/json\""
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.telegramBody }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -3424,
        848
      ],
      "id": "1b8be93f-61d5-417d-8ed8-efb9f4dc6c7a",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å –∑–∞–∫–∞–∑–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "project_assessor",
          "mode": "list",
          "cachedResultName": "project_assessor"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "session_id",
              "value": "={{ $('–î–æ—Å—Ç–∞–µ–º order_id').item.json.order_id }}"
            }
          ]
        },
        "sort": {
          "values": [
            {
              "column": "id",
              "direction": "DESC"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        496,
        240
      ],
      "id": "cfb984aa-f6e2-4425-bf4c-028b92814dcd",
      "name": "–î–æ—Å—Ç–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ —Å –æ—Ü–µ–Ω—â–∏–∫–∞",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ë–µ—Ä–µ–º content –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è\nconst content = $input.first().json.message.content;\n\nif (!content) {\n  throw new Error('content –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ message');\n}\n\n// –ü–∞—Ä—Å–∏–º JSON\nlet parsedContent;\ntry {\n  parsedContent = JSON.parse(content);\n} catch (e) {\n  throw new Error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: ' + e.message);\n}\n\n// –ò–∑–≤–ª–µ–∫–∞–µ–º summary\nconst summary = parsedContent.summary || 'summary –Ω–µ –Ω–∞–π–¥–µ–Ω';\n\nreturn [{\n  json: { summary }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        688,
        240
      ],
      "id": "7d01106b-4351-41f6-91e9-02145b7ec1c7",
      "name": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)3"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "chatId": "={{ $('–î–æ—Å—Ç–∞–µ–º ID —á–∞—Ç–∞').item.json.user_id }}",
        "message": "=–ò—Ç–∞–∫, –≤–∞—à–∞ –∑–∞–¥–∞—á–∞:\n {{ $('–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)3').item.json.summary }}",
        "approvalOptions": {
          "values": {
            "approvalType": "double",
            "approveLabel": "‚úÖ –°–æ–≥–ª–∞—Å–µ–Ω",
            "disapproveLabel": "‚ùå –ù–µ —Å–æ–≥–ª–∞—Å–µ–Ω"
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        880,
        240
      ],
      "id": "2340299a-8ca1-4bc4-80a7-cf0299ec5b8f",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞–¥–∞—á–∏",
      "webhookId": "6fcb7a6b-380e-47d9-9d45-94429b31aef7",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "8e10ab5e-a2d1-4a59-9aff-bd867a27666f",
              "leftValue": "={{ $json.data.approved }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1072,
        240
      ],
      "id": "8abff9a9-7615-4421-bce6-eb381c0b45c8",
      "name": "–°–æ–≥–ª–∞—Å–µ–Ω?"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "orders",
          "mode": "list",
          "cachedResultName": "orders"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "order_id",
              "value": "={{ $json.order_id }}"
            }
          ]
        },
        "options": {
          "outputColumns": [
            "user_id"
          ]
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -80,
        336
      ],
      "id": "f2147775-a55c-497c-bbd1-95f3abc78389",
      "name": "–î–æ—Å—Ç–∞–µ–º ID —á–∞—Ç–∞",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.category }}",
                    "rightValue": "service_request",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "f000e3bd-22d8-462c-829c-ee21e698e941"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ï—Å—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —É—Å–ª—É–≥—É"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7105aa83-11d9-4f58-97bc-5b766b761e22",
                    "leftValue": "={{ $json.category }}",
                    "rightValue": "no_content",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–°–æ–æ–±—â–µ–Ω–∏–µ –±–µ–∑ —Å–º—ã—Å–ª–∞"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7e3df630-c701-4ebc-9734-20d55270a4e6",
                    "leftValue": "={{ $json.category }}",
                    "rightValue": "answer_to_question",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -3424,
        416
      ],
      "id": "98f91bbd-1082-43ae-b702-b93d7c66f160",
      "name": "–ö–∞–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è?"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('–î–æ—Å—Ç–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞').item.json.order_id }}",
        "contextWindowLength": 3
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        -3904,
        640
      ],
      "id": "f26eb761-b12e-432e-a165-7f66a5a067e0",
      "name": "n8n_chat_histories",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('–î–æ—Å—Ç–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞').first().json.order_id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        -2432,
        1040
      ],
      "id": "75f5f971-c993-4f11-bc20-a3588ab601c3",
      "name": "n8n_chat_histories (5)",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–ª—É—á–∞–µ–º –∑–∞–∫–∞–∑—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–æ–¥—ã (–≥–¥–µ –≤—ã–Ω—É–ª–∏ UUID)\nconst orders = $input.all().map(item => item.json.order_id).filter(id => id);\n\n// –ü–æ–ª—É—á–∞–µ–º CHAT_ID –∏–∑ Telegram Trigger\nconst chatId = $('Telegram Trigger').first().json.message?.chat?.id || \n               $('–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏').first().json.result?.chat?.id || \n               null;\n\nif (!orders.length) {\n  return [{\n    json: {\n      message: \"–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π?\",\n      chat_id: chatId,\n      has_orders: false\n    }\n  }];\n}\n\n// –§–æ—Ä–º–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ (–ø–æ 2 –≤ —Ä—è–¥)\nconst inlineKeyboard = [];\nfor (let i = 0; i < orders.length; i += 2) {\n  const row = [];\n  \n  // –ü–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ –≤ —Ä—è–¥—É\n  row.push({\n    text: `–ó–∞–∫–∞–∑ ${orders[i].substring(0, 8)}...`,  // –°–æ–∫—Ä–∞—â–∞–µ–º UUID\n    callback_data: `order_${orders[i]}`\n  });\n  \n  // –í—Ç–æ—Ä–æ–π –∑–∞–∫–∞–∑ (–µ—Å–ª–∏ –µ—Å—Ç—å)\n  if (i + 1 < orders.length) {\n    row.push({\n      text: `–ó–∞–∫–∞–∑ ${orders[i+1].substring(0, 8)}...`,\n      callback_data: `order_${orders[i+1]}`\n    });\n  }\n  \n  inlineKeyboard.push(row);\n}\n\n// –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏ –∫–Ω–æ–ø–∫—É \"—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π\"\ninlineKeyboard.push([{ text: \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\", callback_data: \"ignore\" }]);\ninlineKeyboard.push([{ \n  text: \"‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑\", \n  callback_data: \"new_order\" \n}]);\n\n// Telegram message\nconst telegramMessage = `üìã **–£ –≤–∞—Å –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã. –ü–æ –∫–∞–∫–æ–º—É –∏–∑ –Ω–∏—Ö –ø—Ä–æ–¥–æ–ª–∂–∏–º –æ–±—â–µ–Ω–∏–µ?**\\n\\n`;\n\nconst result = {\n  chat_id: chatId,\n  total_orders: orders.length,\n  orders,\n  \n  telegramBodyString: JSON.stringify({\n    chat_id: chatId,\n    text: telegramMessage,\n    reply_markup: {\n      inline_keyboard: inlineKeyboard\n    },\n    parse_mode: \"Markdown\"\n  }, null, 2),\n  \n  telegramBody: {\n    chat_id: chatId,\n    text: telegramMessage,\n    reply_markup: {\n      inline_keyboard: inlineKeyboard\n    },\n    parse_mode: \"Markdown\"\n  },\n  \n  inlineKeyboard,\n  messagePreview: telegramMessage,\n  \n  debug: {\n    chatIdFound: !!chatId,\n    ordersFound: orders.length\n  }\n};\n\nreturn [{\n  json: result\n}];\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3632,
        848
      ],
      "id": "dd790cac-0912-4d09-8032-f0fcf41a5efb",
      "name": "–°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–∞–∑–æ–≤"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤').item.json.order_id }}",
        "tableName": "project_assessor",
        "contextWindowLength": 1
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        -1664,
        640
      ],
      "id": "c5c641dc-02a2-4c7d-94c0-fbf048c8c29a",
      "name": "project_assessor",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').first().json.message.from.id }}",
        "text": "=–í–∞—à –ø—Ä–æ–µ–∫—Ç –æ—Ü–µ–Ω–µ–Ω –∫–∞–∫ —Å–ª–æ–∂–Ω—ã–π. –ò –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞. –ú—ã –æ—Ü–µ–Ω–∏–≤–∞–µ–º –í–∞—à –ø—Ä–æ–µ–∫—Ç –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –æ—Ü–µ–Ω–∫–∞–º:\n{{ $('–î–æ—Å—Ç–∞–µ–º —á–∏—Å–ª–æ –æ—Ü–µ–Ω–∫–∏').item.json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -656,
        528
      ],
      "id": "4f49118e-1367-4939-a985-c5650644d468",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET status = '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ'\nWHERE order_id = '{{ $('–î–æ—Å—Ç–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞').item.json.session_id }}';\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -848,
        336
      ],
      "id": "ef1b02ae-3af1-47c4-9d12-8c9591b7d65a",
      "name": "–°—Ç–∞—Ç—É—Å = –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET status = '–î–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ–º—Å—è –æ –¥–æ–ø –≤—Å—Ç—Ä–µ—á–µ'\nWHERE order_id = '{{ $('–î–æ—Å—Ç–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞').item.json.session_id }}';\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -848,
        528
      ],
      "id": "4ed0f183-de49-4ae1-9ac4-6145de9d6c06",
      "name": "–°—Ç–∞—Ç—É—Å = –î–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ–º—Å—è –æ –¥–æ–ø. –≤—Å—Ç—Ä–µ—á–µ",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.tracker.yandex.net/v2/issues/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer y0__xCSkap5GJL7OSCct86iFO3Omy-jZfx8RrhCRfPbQOfSyepu"
            },
            {
              "name": "X-Cloud-Org-Id",
              "value": "bpfv9t63mra98pbkbu1t"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"summary\": \"–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑ {{ $('–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤').item.json.order_id }}\",\n  \"queue\": \"DEVTEAM\"\n} ",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -656,
        336
      ],
      "id": "a8f11c9c-f439-4182-8b4b-f0b459dc1936",
      "name": "–ó–∞–¥–∞—á–∞ –≤ —Ç—Ä–µ–∫–µ—Ä–µ = –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑"
    },
    {
      "parameters": {
        "jsCode": "const text = $input.first().json.body.issue.summary;\n\n// –ò—â–µ–º UUID –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ–±–µ–ª–∞\nconst lastSpaceIndex = text.lastIndexOf(' ');\nconst potentialUuid = lastSpaceIndex > 0 ? text.substring(lastSpaceIndex + 1) : null;\n\nconst orderId = potentialUuid && /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(potentialUuid) \n  ? potentialUuid \n  : null;\n\nreturn [{\n  json: {\n    order_id: orderId\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -272,
        336
      ],
      "id": "a6a5c502-6821-4b8d-86bf-4e31855ac99a",
      "name": "–î–æ—Å—Ç–∞–µ–º order_id"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏').item.json.body.issue.status }}",
                    "rightValue": "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "7dfb5e01-69a9-4475-bd97-38117ca699fd"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5effe3c4-5f50-4621-83e0-9f2859ee991d",
                    "leftValue": "={{ $('Webhook –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏').item.json.body.issue.status }}",
                    "rightValue": "–ù–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        112,
        336
      ],
      "id": "23e20f22-dd63-457a-9327-334a1566c710",
      "name": "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ?"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.tracker.yandex.net/v2/issues/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer y0__xCSkap5GJL7OSCct86iFO3Omy-jZfx8RrhCRfPbQOfSyepu"
            },
            {
              "name": "X-Cloud-Org-Id",
              "value": "bpfv9t63mra98pbkbu1t"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"summary\": \"{{ $json.summary }}\",\n  \"queue\": \"DEVTEAM\"\n} ",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -3920,
        -128
      ],
      "id": "9bf3ef31-57fa-48a1-a35a-676d0d2d4d63",
      "name": "–ó–∞–¥–∞—á–∞ –≤ —Ç—Ä–µ–∫–µ—Ä–µ = –í—Å—Ç—Ä–µ—á–∞ –ø–æ –∑–∞–∫–∞–∑—É"
    },
    {
      "parameters": {
        "jsCode": "// –ë–µ—Ä–µ–º data –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞\nconst data = $input.first().json.callback_query.data;\n\nif (!data) {\n  throw new Error('data –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n}\n\n// –í—ã—Ä–µ–∑–∞–µ–º UUID –ø–æ—Å–ª–µ \"order_\"\nconst orderId = data.replace('order_', '');\n\nreturn [{\n  json: { \n    order_number: orderId  // c1684d0d-3907-41a5-aa93-9fb8a49d3269\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4560,
        1552
      ],
      "id": "5c731048-9f32-4810-b1af-112009293bfa",
      "name": "–í—ã–Ω–∏–º–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO orders (user_id)\nVALUES ({{ $('Telegram Trigger').item.json.callback_query.message.chat.id }})\nRETURNING order_id;",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -4160,
        1424
      ],
      "id": "48c94e41-22f1-4656-a011-5869dfd7dc2c",
      "name": "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞1",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5a6cfa9f-71e2-43b5-9f9b-e9e221e7312c",
              "leftValue": "={{ $json.order_number }}",
              "rightValue": "new_order",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4352,
        1552
      ],
      "id": "97dd7f3f-6085-4e9b-9674-6b700e0e0c9d",
      "name": "–ù–æ–≤—ã–π –∑–∞–∫–∞–∑?"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–µ—Å–µ–π–ª—É –∏ –±—Ä–∏—Ñ–æ–≤–∞–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å—Ñ–µ—Ä–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤.\n\n–£ —Ç–µ–±—è –µ—Å—Ç—å:\n- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ n8n_chat_histories\n\n–ó–∞–¥–∞—á–∞: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –†–û–í–ù–û –û–î–ò–ù –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–∞.\n\n–ü—Ä–∞–≤–∏–ª–∞:\n- –í–æ–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º, –ø–æ–Ω—è—Ç–Ω—ã–º, –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∂–∞—Ä–≥–æ–Ω–∞\n- –ù–∞—á–∏–Ω–∞–π —Å –æ–±—â–µ–≥–æ, –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –¥–µ—Ç–∞–ª—è–º –ø–æ –º–µ—Ä–µ –¥–∏–∞–ª–æ–≥–∞\n- –£—á–∏—Ç—ã–≤–∞–π –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞\n- –ù–µ –æ—Ç–≤–µ—á–∞–π –∑–∞ –∫–ª–∏–µ–Ω—Ç–∞, –Ω–µ –¥–µ–ª–∞–π –≤—ã–≤–æ–¥–æ–≤\n\n–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: –¢–û–õ–¨–ö–û –≤–æ–ø—Ä–æ—Å –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É\n\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -2640,
        1664
      ],
      "id": "1757296c-846d-4d08-add6-13f75f1b6f69",
      "name": "–ü–æ—á–µ–º—É—á–∫–∞2"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.callback_query.from.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -2288,
        1664
      ],
      "id": "c0df55f4-1bfe-4c6a-9566-0b417a68656f",
      "name": "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞2",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET status = '–£—Ç–æ—á–Ω–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π', \n    questions_count = questions_count + 1, \n    last_contact_at = CURRENT_TIMESTAMP \nWHERE order_id = '{{ $('–í—ã–Ω–∏–º–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞').item.json.order_number }}';\n\n\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -2064,
        1664
      ],
      "id": "3b2d9a54-97aa-4a39-b2a1-23b946ca380f",
      "name": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞4",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.order_id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        -2576,
        1872
      ],
      "id": "fe7fadd7-ab18-45f6-aee4-aad515052748",
      "name": "Postgres Chat Memory3",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "orders",
          "mode": "list",
          "cachedResultName": "orders"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "order_id",
              "value": "={{ $('–í—ã–Ω–∏–º–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞').item.json.order_number }}"
            }
          ]
        },
        "options": {
          "outputColumns": [
            "questions_count",
            "user_id",
            "order_id"
          ]
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3168,
        1760
      ],
      "id": "0e9b046b-000d-4535-accb-36244efddad8",
      "name": "–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤1",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "37f262ea-5036-4c99-972a-4d28cccb2bc5",
              "leftValue": "={{ $json.questions_count }}",
              "rightValue": 3,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2976,
        1760
      ],
      "id": "704d24d8-de4e-406e-aee8-06f62559ec0f",
      "name": "–ú–µ–Ω—å—à–µ 3 ?1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.callback_query.message.chat.id }}",
        "text": "=–û—Ç–ª–∏—á–Ω–æ! –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ ‚Ññ{{ $json.order_id }} —Å–æ–∑–¥–∞–Ω.\n\n–ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ (—á—Ç–æ –Ω—É–∂–Ω–æ, —Å—Ä–æ–∫–∏, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏)",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3936,
        1424
      ],
      "id": "33cb97e4-4b20-4b93-b107-7c4a54e5a1f5",
      "name": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –Ω–æ–≤–æ–º—É –∑–∞–∫–∞–∑—É",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const isoDate = $('–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏').first().json.startTime;\nconst date = new Date(isoDate);\n\n// –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Å—è—Ü–µ–≤\nconst months = [\n  \"—è–Ω–≤–∞—Ä—è\", \"—Ñ–µ–≤—Ä–∞–ª—è\", \"–º–∞—Ä—Ç–∞\", \"–∞–ø—Ä–µ–ª—è\", \"–º–∞—è\", \"–∏—é–Ω—è\",\n  \"–∏—é–ª—è\", \"–∞–≤–≥—É—Å—Ç–∞\", \"—Å–µ–Ω—Ç—è–±—Ä—è\", \"–æ–∫—Ç—è–±—Ä—è\", \"–Ω–æ—è–±—Ä—è\", \"–¥–µ–∫–∞–±—Ä—è\"\n];\n\nconst day = date.getDate();\nconst month = months[date.getMonth()];\nconst hours = date.getHours();\nconst minutes = date.getMinutes().toString().padStart(2, '0');\n\nconst result = `${day} ${month} –≤ ${hours}:${minutes}`;\n\nreturn [{\n  json: { formatted: result }  // \"26 –¥–µ–∫–∞–±—Ä—è –≤ 15:30\"\n}];\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4112,
        80
      ],
      "id": "78fa1bbf-444c-4a14-a2b6-9ff241eaf36e",
      "name": "–ü–µ—Ä–µ–≤–æ–¥ –¥–∞—Ç—ã –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.callback_query.message.chat.id }}",
        "text": "=–ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3936,
        1648
      ],
      "id": "55f66542-c01c-4eb5-a04a-5b8ad11eff84",
      "name": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0f5e9b94-5f5e-4d95-95db-d7ad374b0b10",
              "leftValue": "={{ $json.message.entities[0].type }}",
              "rightValue": "bot_command",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -5488,
        784
      ],
      "id": "7f250796-4f42-4c2b-a472-afde00c47bc9",
      "name": "–°—Ç–∞—Ä—Ç?"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0f5e9b94-5f5e-4d95-95db-d7ad374b0b10",
              "leftValue": "={{ $json.callback_query.data }}",
              "rightValue": "order",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -5312,
        784
      ],
      "id": "fe8b661b-38a6-4307-891b-8f8d34f6449f",
      "name": "–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞?"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0f5e9b94-5f5e-4d95-95db-d7ad374b0b10",
              "leftValue": "={{ $json.callback_query.data }}",
              "rightValue": "book",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -5136,
        784
      ],
      "id": "80a56e35-415e-4687-aacb-8d77350324af",
      "name": "–ö–Ω–æ–ø–∫–∞ —Å –¥–∞—Ç–æ–π?"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0f5e9b94-5f5e-4d95-95db-d7ad374b0b10",
              "leftValue": "={{ $json.message.entities[0].type }}",
              "rightValue": "phone_number",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4944,
        784
      ],
      "id": "b9163c5b-f62b-4a1b-8beb-29e50c1239ab",
      "name": "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞?"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE orders \nSET  last_contact_at = CURRENT_TIMESTAMP \nWHERE order_id = '{{ $('–í—ã–Ω–∏–º–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞').item.json.order_number }}';\n\n\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -4160,
        1648
      ],
      "id": "1344f8b0-53eb-4f7a-a58e-b67c2ee092b1",
      "name": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞1",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "orders",
          "mode": "list",
          "cachedResultName": "orders"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "user_id",
              "value": "={{ $('Telegram Trigger').item.json.message.from.id }}"
            }
          ]
        },
        "sort": {
          "values": [
            {
              "column": "last_contact_at",
              "direction": "DESC"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -4688,
        464
      ],
      "id": "253a3d87-04f9-408b-b5fb-295a30c503f6",
      "name": "–î–æ—Å—Ç–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e0155c92-bd09-411e-b6ad-fb7c25a480c6",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4496,
        464
      ],
      "id": "52c66fee-2603-4b54-bc5f-a0b791b83e90",
      "name": "–ó–∞–∫–∞–∑ –µ—Å—Ç—å?1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=–ù–∞–∂–º–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ä—Ç",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4304,
        576
      ],
      "id": "a839cde3-06ac-45de-a882-c705c3498b2c",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞–∂–º–∏—Ç–µ \"—Å—Ç–∞—Ä—Ç\"",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "dbf32178-7ad0-4f6c-b930-137cee5bb555",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -3808,
        992
      ],
      "id": "4454af62-5520-4d38-a483-85e8cadbec40",
      "name": "–ï—Å—Ç—å –∑–∞–∫–∞–∑—ã?"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO orders (user_id)\nVALUES ({{ $('Telegram Trigger').item.json.message.chat.id }})\nRETURNING order_id;",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3632,
        1088
      ],
      "id": "8b32cfeb-6a71-4fee-bb02-c0b20e021cc4",
      "name": "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞2",
      "credentials": {
        "postgres": {
          "id": "vtYFdmdoEtMRqK80",
          "name": "RAG Agent with Memory"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=–ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3424,
        1088
      ],
      "id": "a7b25756-036e-46ec-b609-41c2b29c9359",
      "name": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –Ω–æ–≤–æ–º—É –∑–∞–∫–∞–∑—É1",
      "webhookId": "46a1a701-f126-4f99-989e-30983418ca2c",
      "credentials": {
        "telegramApi": {
          "id": "ga9barrv03nsiRK8",
          "name": "–ë–æ—Ç-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Embeddings Google Gemini": {
      "ai_embedding": [
        [
          {
            "node": "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –ë–î",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "–ë–µ—Ä–µ–º —É—Å–ª—É–≥–∏ —Å —Ç–∞–±–ª–∏—Ü—ã": {
      "main": [
        [
          {
            "node": "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –ë–î",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–∑–¥–∞–Ω–∏–µ —á–∞–Ω–∫–æ–≤": {
      "ai_textSplitter": [
        [
          {
            "node": "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö": {
      "ai_document": [
        [
          {
            "node": "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –ë–î",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Supabase Vector Store": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Google Gemini2": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Execute a SQL query": {
      "main": [
        [
          {
            "node": "–ë–µ—Ä–µ–º —É—Å–ª—É–≥–∏ —Å —Ç–∞–±–ª–∏—Ü—ã",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "–û—Ü–µ–Ω—â–∏–∫",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π": {
      "main": [
        [
          {
            "node": "–í—ã–Ω–∏–º–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–í—ã–Ω–∏–º–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å JSON": {
      "main": [
        [
          {
            "node": "–ö–∞–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü–æ—á–µ–º—É—á–∫–∞": {
      "main": [
        [
          {
            "node": "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤": {
      "main": [
        [
          {
            "node": "–í—ã–Ω–∏–º–∞–µ–º —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å —Å JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–í—ã–Ω–∏–º–∞–µ–º —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å —Å JSON": {
      "main": [
        [
          {
            "node": "–ù–∞–¥–æ —É—Ç–æ—á–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "–ü–æ—á–µ–º—É—á–∫–∞",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "–ü–æ—á–µ–º—É—á–∫–∞2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞": {
      "main": [
        [
          {
            "node": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å –ª–∏ –∫–ª–∏–µ–Ω—Ç –≤ –ë–î": {
      "main": [
        [
          {
            "node": "–ö–ª–∏–µ–Ω—Ç —É–∂–µ –µ—Å—Ç—å?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–ª–∏–µ–Ω—Ç —É–∂–µ –µ—Å—Ç—å?": {
      "main": [
        [
          {
            "node": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã –ø–æ—Å–µ—â–µ–Ω–∏—è –≤ clients",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ó–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞": {
      "main": [
        [
          {
            "node": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤": {
      "main": [
        [
          {
            "node": "–ú–µ–Ω—å—à–µ 3 ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ú–µ–Ω—å—à–µ 3 ?": {
      "main": [
        [
          {
            "node": "–ü–æ—á–µ–º—É—á–∫–∞",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ù–∞–¥–æ —É—Ç–æ—á–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç?": {
      "main": [
        [
          {
            "node": "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã –ø–æ—Å–µ—â–µ–Ω–∏—è –≤ clients": {
      "main": [
        [
          {
            "node": "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û—Ç–≤–µ—Ç –Ω–∞ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å": {
      "main": [
        []
      ]
    },
    "–ó–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞": {
      "main": [
        []
      ]
    },
    "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤": {
      "main": [
        [
          {
            "node": "–ï—Å—Ç—å –∑–∞–∫–∞–∑—ã?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û—Ü–µ–Ω—â–∏–∫": {
      "main": [
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º —á–∏—Å–ª–æ –æ—Ü–µ–Ω–∫–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞": {
      "main": [
        [
          {
            "node": "–û—Ü–µ–Ω—â–∏–∫",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º —á–∏—Å–ª–æ –æ—Ü–µ–Ω–∫–∏": {
      "main": [
        [
          {
            "node": "–ë–æ–ª—å—à–µ 70 ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–æ–ª—å—à–µ 70 ?": {
      "main": [
        [
          {
            "node": "–°—Ç–∞—Ç—É—Å = –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–°—Ç–∞—Ç—É—Å = –î–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ–º—Å—è –æ –¥–æ–ø. –≤—Å—Ç—Ä–µ—á–µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π": {
      "main": [
        [
          {
            "node": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–ª–æ—Ç–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏": {
      "main": [
        [
          {
            "node": "–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ –ª–∏ –≤—Ä–µ–º—è": {
      "main": [
        [
          {
            "node": "–í—Ä–µ–º—è —Å–≤–æ–±–æ–¥–Ω–æ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏": {
      "main": [
        [
          {
            "node": "–ó–∞–¥–∞—á–∞ –≤ —Ç—Ä–µ–∫–µ—Ä–µ = –í—Å—Ç—Ä–µ—á–∞ –ø–æ –∑–∞–∫–∞–∑—É",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–í—Ä–µ–º—è —Å–≤–æ–±–æ–¥–Ω–æ?": {
      "main": [
        [
          {
            "node": "–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ü–µ—Ä–µ–≤–æ–¥ –¥–∞—Ç—ã –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏": {
      "main": [
        [
          {
            "node": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ –ª–∏ –≤—Ä–µ–º—è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ": {
      "main": [
        [
          {
            "node": "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π1": {
      "main": [
        [
          {
            "node": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)1": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–ª–æ—Ç–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞3": {
      "main": [
        [
          {
            "node": "–ü–µ—Ä–µ–≤–æ–¥ –¥–∞—Ç—ã –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Å—Ç—Ä–µ—á–∞ —Å–æ–∑–¥–∞–Ω–∞": {
      "main": [
        []
      ]
    },
    "–ü–µ—Ä–µ–≤–æ–¥ –¥–∞—Ç—ã –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Å—Ç—Ä–µ—á–∞ —Å–æ–∑–¥–∞–Ω–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏": {
      "main": [
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º order_id",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑ = –ó–∞–¥–∞—á–∞ –Ω–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞": {
      "main": [
        [
          {
            "node": "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π2": {
      "main": [
        [
          {
            "node": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)2": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–ª–æ—Ç–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "–°—Ç–∞—Ä—Ç?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°—Ç–∞—Ç—É—Å = –ó–∞–¥–∞—á–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞": {
      "main": [
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ —Å –æ—Ü–µ–Ω—â–∏–∫–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ —Å –æ—Ü–µ–Ω—â–∏–∫–∞": {
      "main": [
        [
          {
            "node": "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–§–æ—Ä–º-–µ —Å–æ–æ–±—â-—è —Å –∫–Ω–æ–ø–∫–∞–º–∏(—Å–≤–æ–±–æ–¥–Ω—ã—Ö –¥–∞—Ç—ã)3": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞–¥–∞—á–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞–¥–∞—á–∏": {
      "main": [
        [
          {
            "node": "–°–æ–≥–ª–∞—Å–µ–Ω?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–≥–ª–∞—Å–µ–Ω?": {
      "main": [
        [],
        [
          {
            "node": "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º ID —á–∞—Ç–∞": {
      "main": [
        [
          {
            "node": "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–∞–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è?": {
      "main": [
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–û—Ç–≤–µ—Ç –Ω–∞ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "n8n_chat_histories": {
      "ai_memory": [
        [
          {
            "node": "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "n8n_chat_histories (5)": {
      "ai_memory": [
        [
          {
            "node": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤",
            "type": "ai_memory",
            "index": 0
          },
          {
            "node": "–ü–æ—á–µ–º—É—á–∫–∞",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–∞–∑–æ–≤": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ —Å –∑–∞–∫–∞–∑–∞–º–∏ - –∫–Ω–æ–ø–∫–∞–º–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "project_assessor": {
      "ai_memory": [
        [
          {
            "node": "–û—Ü–µ–Ω—â–∏–∫",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏": {
      "main": [
        [
          {
            "node": "–ü–æ–ª—É—á–∞–µ–º –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∑–∞ 5 –¥–Ω–µ–π",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°—Ç–∞—Ç—É—Å = –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ": {
      "main": [
        [
          {
            "node": "–ó–∞–¥–∞—á–∞ –≤ —Ç—Ä–µ–∫–µ—Ä–µ = –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°—Ç–∞—Ç—É—Å = –î–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ–º—Å—è –æ –¥–æ–ø. –≤—Å—Ç—Ä–µ—á–µ": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º order_id": {
      "main": [
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º ID —á–∞—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ?": {
      "main": [
        [
          {
            "node": "–°—Ç–∞—Ç—É—Å = –ó–∞–¥–∞—á–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑ = –ó–∞–¥–∞—á–∞ –Ω–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ó–∞–¥–∞—á–∞ –≤ —Ç—Ä–µ–∫–µ—Ä–µ = –í—Å—Ç—Ä–µ—á–∞ –ø–æ –∑–∞–∫–∞–∑—É": {
      "main": [
        [
          {
            "node": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–í—ã–Ω–∏–º–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞": {
      "main": [
        [
          {
            "node": "–ù–æ–≤—ã–π –∑–∞–∫–∞–∑?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ù–æ–≤—ã–π –∑–∞–∫–∞–∑?": {
      "main": [
        [
          {
            "node": "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞1": {
      "main": [
        [
          {
            "node": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –Ω–æ–≤–æ–º—É –∑–∞–∫–∞–∑—É",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞": {
      "main": [
        []
      ]
    },
    "–ü–æ—á–µ–º—É—á–∫–∞2": {
      "main": [
        [
          {
            "node": "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞2": {
      "main": [
        [
          {
            "node": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory3": {
      "ai_memory": [
        [
          {
            "node": "–ü–æ—á–µ–º—É—á–∫–∞2",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤1": {
      "main": [
        [
          {
            "node": "–ú–µ–Ω—å—à–µ 3 ?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ú–µ–Ω—å—à–µ 3 ?1": {
      "main": [
        [
          {
            "node": "–ü–æ—á–µ–º—É—á–∫–∞2",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "–ü–µ—Ä–µ–≤–æ–¥ –¥–∞—Ç—ã –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç1": {
      "main": [
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å": {
      "main": [
        []
      ]
    },
    "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –Ω–æ–≤–æ–º—É –∑–∞–∫–∞–∑—É": {
      "main": [
        []
      ]
    },
    "–°—Ç–∞—Ä—Ç?": {
      "main": [
        [
          {
            "node": "–ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å –ª–∏ –∫–ª–∏–µ–Ω—Ç –≤ –ë–î",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞?": {
      "main": [
        [
          {
            "node": "–í—ã–Ω–∏–º–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ö–Ω–æ–ø–∫–∞ —Å –¥–∞—Ç–æ–π?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–Ω–æ–ø–∫–∞ —Å –¥–∞—Ç–æ–π?": {
      "main": [
        [
          {
            "node": "–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞?": {
      "main": [
        [
          {
            "node": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–î–æ—Å—Ç–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞1": {
      "main": [
        [
          {
            "node": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–î–æ—Å—Ç–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞": {
      "main": [
        [
          {
            "node": "–ó–∞–∫–∞–∑ –µ—Å—Ç—å?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ó–∞–∫–∞–∑ –µ—Å—Ç—å?1": {
      "main": [
        [
          {
            "node": "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞–∂–º–∏—Ç–µ \"—Å—Ç–∞—Ä—Ç\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ï—Å—Ç—å –∑–∞–∫–∞–∑—ã?": {
      "main": [
        [
          {
            "node": "–°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–∞–∑–æ–≤",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞2": {
      "main": [
        [
          {
            "node": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –Ω–æ–≤–æ–º—É –∑–∞–∫–∞–∑—É1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "19ec981b-c16d-434f-8c11-01d616337160",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "0b50e4099c768129fcea26f3dd1a4f67f1b422c1a61e0bc95bce1a80e5893cb2"
  },
  "id": "u0oM0KUUnG2pA5EZ",
  "tags": []
}